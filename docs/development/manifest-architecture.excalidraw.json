{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "id": "title",
      "type": "text",
      "x": 400,
      "y": 20,
      "width": 300,
      "height": 35,
      "text": "Manifest System Architecture",
      "fontSize": 28,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 25,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 1
    },
    {
      "id": "trait-box",
      "type": "rectangle",
      "x": 350,
      "y": 80,
      "width": 400,
      "height": 280,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 2
    },
    {
      "id": "trait-title",
      "type": "text",
      "x": 450,
      "y": 90,
      "width": 200,
      "height": 25,
      "text": "<<trait>> ManifestStore",
      "fontSize": 20,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 3
    },
    {
      "id": "trait-methods",
      "type": "text",
      "x": 370,
      "y": 125,
      "width": 360,
      "height": 220,
      "text": "Methods:\n+ get(&self, id: &ActionId) -> Option<&Version>\n+ set(&mut self, id: ActionId, version: Version)\n+ has(&self, id: &ActionId) -> bool\n+ save(&mut self) -> Result<(), ManifestError>\n+ specs(&self) -> Vec<ActionSpec>\n+ remove(&mut self, id: &ActionId)\n+ path(&self) -> Result<&Path, ManifestError>\n+ is_empty(&self) -> bool",
      "fontSize": 14,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 200,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 4
    },
    {
      "id": "file-manifest-box",
      "type": "rectangle",
      "x": 80,
      "y": 450,
      "width": 360,
      "height": 280,
      "strokeColor": "#1971c2",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 5
    },
    {
      "id": "file-manifest-title",
      "type": "text",
      "x": 180,
      "y": 460,
      "width": 160,
      "height": 25,
      "text": "FileManifest",
      "fontSize": 20,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 6
    },
    {
      "id": "file-manifest-fields",
      "type": "text",
      "x": 100,
      "y": 495,
      "width": 320,
      "height": 220,
      "text": "Fields:\n- actions: HashMap<ActionId, Version>\n- path: Option<PathBuf>\n- dirty: bool  (tracks changes)\n\nMethods:\n+ load(path: &Path) -> Result<Self>\n+ load_or_default(path: &Path) -> Result<Self>\n- save_to_disk(&self) -> Result<()>\n\nBehavior:\n- Persists to .github/gx.toml\n- Only saves when dirty=true\n- Logs on save",
      "fontSize": 13,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 200,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 7
    },
    {
      "id": "memory-manifest-box",
      "type": "rectangle",
      "x": 660,
      "y": 450,
      "width": 320,
      "height": 220,
      "strokeColor": "#e8590c",
      "backgroundColor": "#ffd8a8",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 8
    },
    {
      "id": "memory-manifest-title",
      "type": "text",
      "x": 740,
      "y": 460,
      "width": 160,
      "height": 25,
      "text": "MemoryManifest",
      "fontSize": 20,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 9
    },
    {
      "id": "memory-manifest-fields",
      "type": "text",
      "x": 680,
      "y": 495,
      "width": 280,
      "height": 160,
      "text": "Fields:\n- actions: HashMap<ActionId, Version>\n\nMethods:\n+ from_workflows(action_set) -> Self\n\nBehavior:\n- No file persistence\n- save() is a no-op\n- path() returns Ok(\"in-memory\")\n- Used when no gx.toml exists",
      "fontSize": 13,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 140,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 10
    },
    {
      "id": "impl-arrow-left",
      "type": "arrow",
      "x": 260,
      "y": 450,
      "width": 140,
      "height": 80,
      "points": [[0, 0], [140, -80], [140, -90]],
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 11,
      "startArrowhead": null,
      "endArrowhead": "triangle"
    },
    {
      "id": "impl-arrow-right",
      "type": "arrow",
      "x": 820,
      "y": 450,
      "width": 140,
      "height": 80,
      "points": [[0, 0], [-140, -80], [-140, -90]],
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 12,
      "startArrowhead": null,
      "endArrowhead": "triangle"
    },
    {
      "id": "impl-label-left",
      "type": "text",
      "x": 295,
      "y": 395,
      "width": 80,
      "height": 20,
      "text": "implements",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 14,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 13
    },
    {
      "id": "impl-label-right",
      "type": "text",
      "x": 715,
      "y": 395,
      "width": 80,
      "height": 20,
      "text": "implements",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 14,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 14
    },
    {
      "id": "toml-file-box",
      "type": "rectangle",
      "x": 80,
      "y": 780,
      "width": 360,
      "height": 180,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 15
    },
    {
      "id": "toml-file-title",
      "type": "text",
      "x": 180,
      "y": 790,
      "width": 160,
      "height": 25,
      "text": ".github/gx.toml",
      "fontSize": 18,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 16
    },
    {
      "id": "toml-content",
      "type": "text",
      "x": 100,
      "y": 825,
      "width": 320,
      "height": 120,
      "text": "[actions]\n\"actions/checkout\" = \"v4\"\n\"actions/setup-node\" = \"v4\"\n\"docker/build-push-action\" = \"v5\"",
      "fontSize": 14,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 100,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 17
    },
    {
      "id": "file-to-toml-arrow",
      "type": "arrow",
      "x": 260,
      "y": 730,
      "width": 0,
      "height": 40,
      "points": [[0, 0], [0, 40]],
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 18,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "read-write-label",
      "type": "text",
      "x": 270,
      "y": 740,
      "width": 100,
      "height": 20,
      "text": "reads/writes",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "left",
      "baseline": 14,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 19
    },
    {
      "id": "domain-types-box",
      "type": "rectangle",
      "x": 820,
      "y": 80,
      "width": 260,
      "height": 180,
      "strokeColor": "#f08c00",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 20
    },
    {
      "id": "domain-types-title",
      "type": "text",
      "x": 880,
      "y": 90,
      "width": 140,
      "height": 25,
      "text": "Domain Types",
      "fontSize": 18,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 21
    },
    {
      "id": "domain-types-content",
      "type": "text",
      "x": 840,
      "y": 125,
      "width": 220,
      "height": 120,
      "text": "ActionId(String)\n  e.g., \"actions/checkout\"\n\nVersion(String)\n  e.g., \"v4\"\n\nActionSpec { id, version }",
      "fontSize": 13,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 100,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 22
    },
    {
      "id": "trait-to-domain-arrow",
      "type": "arrow",
      "x": 750,
      "y": 170,
      "width": 60,
      "height": 0,
      "points": [[0, 0], [60, 0]],
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 23,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "uses-label",
      "type": "text",
      "x": 765,
      "y": 150,
      "width": 40,
      "height": 20,
      "text": "uses",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 14,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 24
    },
    {
      "id": "manifest-data-box",
      "type": "rectangle",
      "x": 500,
      "y": 780,
      "width": 280,
      "height": 140,
      "strokeColor": "#495057",
      "backgroundColor": "#dee2e6",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 25
    },
    {
      "id": "manifest-data-title",
      "type": "text",
      "x": 560,
      "y": 790,
      "width": 160,
      "height": 25,
      "text": "ManifestData (internal)",
      "fontSize": 16,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 26
    },
    {
      "id": "manifest-data-content",
      "type": "text",
      "x": 520,
      "y": 825,
      "width": 240,
      "height": 80,
      "text": "Used for TOML serialization\n\nactions: HashMap<String, String>\n\n#[derive(Deserialize, Serialize)]",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 70,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 27
    },
    {
      "id": "toml-to-data-arrow",
      "type": "arrow",
      "x": 440,
      "y": 850,
      "width": 50,
      "height": 0,
      "points": [[0, 0], [50, 0]],
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 28,
      "startArrowhead": "arrow",
      "endArrowhead": "arrow"
    },
    {
      "id": "serde-label",
      "type": "text",
      "x": 442,
      "y": 830,
      "width": 50,
      "height": 20,
      "text": "serde",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 14,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 29
    },
    {
      "id": "error-box",
      "type": "rectangle",
      "x": 820,
      "y": 290,
      "width": 260,
      "height": 130,
      "strokeColor": "#c92a2a",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 30
    },
    {
      "id": "error-title",
      "type": "text",
      "x": 880,
      "y": 300,
      "width": 140,
      "height": 25,
      "text": "ManifestError",
      "fontSize": 18,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 31
    },
    {
      "id": "error-content",
      "type": "text",
      "x": 840,
      "y": 330,
      "width": 220,
      "height": 80,
      "text": "- Read { path, source }\n- Parse { path, source }\n- Write { path, source }\n- Serialize(source)\n- PathNotInitialized",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 70,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 32
    },
    {
      "id": "trait-to-error-arrow",
      "type": "arrow",
      "x": 750,
      "y": 280,
      "width": 60,
      "height": 60,
      "points": [[0, 0], [60, 60]],
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 33,
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "returns-label",
      "type": "text",
      "x": 775,
      "y": 290,
      "width": 50,
      "height": 20,
      "text": "returns",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 14,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 34
    },
    {
      "id": "flow-box",
      "type": "rectangle",
      "x": 80,
      "y": 1000,
      "width": 700,
      "height": 140,
      "strokeColor": "#364fc7",
      "backgroundColor": "#dbe4ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 0,
      "opacity": 100,
      "seed": 35
    },
    {
      "id": "flow-title",
      "type": "text",
      "x": 350,
      "y": 1010,
      "width": 160,
      "height": 25,
      "text": "Data Flow",
      "fontSize": 18,
      "fontFamily": 1,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 36
    },
    {
      "id": "flow-content",
      "type": "text",
      "x": 100,
      "y": 1045,
      "width": 660,
      "height": 80,
      "text": "1. main.rs checks if gx.toml exists\n2. If exists: inject FileManifest  |  If not: inject MemoryManifest\n3. tidy::run<M: ManifestStore>() works with trait abstraction\n4. FileManifest.save() persists to disk  |  MemoryManifest.save() is no-op",
      "fontSize": 14,
      "fontFamily": 3,
      "textAlign": "left",
      "baseline": 70,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 37
    },
    {
      "id": "legend-title",
      "type": "text",
      "x": 80,
      "y": 80,
      "width": 80,
      "height": 20,
      "text": "Legend:",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "left",
      "baseline": 14,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 38
    },
    {
      "id": "legend-green",
      "type": "rectangle",
      "x": 80,
      "y": 105,
      "width": 20,
      "height": 20,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 39
    },
    {
      "id": "legend-green-text",
      "type": "text",
      "x": 110,
      "y": 107,
      "width": 60,
      "height": 16,
      "text": "Trait",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 40
    },
    {
      "id": "legend-blue",
      "type": "rectangle",
      "x": 80,
      "y": 130,
      "width": 20,
      "height": 20,
      "strokeColor": "#1971c2",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 41
    },
    {
      "id": "legend-blue-text",
      "type": "text",
      "x": 110,
      "y": 132,
      "width": 120,
      "height": 16,
      "text": "File-backed impl",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 42
    },
    {
      "id": "legend-orange",
      "type": "rectangle",
      "x": 80,
      "y": 155,
      "width": 20,
      "height": 20,
      "strokeColor": "#e8590c",
      "backgroundColor": "#ffd8a8",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 43
    },
    {
      "id": "legend-orange-text",
      "type": "text",
      "x": 110,
      "y": 157,
      "width": 120,
      "height": 16,
      "text": "In-memory impl",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 44
    },
    {
      "id": "legend-purple",
      "type": "rectangle",
      "x": 80,
      "y": 180,
      "width": 20,
      "height": 20,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 45
    },
    {
      "id": "legend-purple-text",
      "type": "text",
      "x": 110,
      "y": 182,
      "width": 80,
      "height": 16,
      "text": "File format",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 0,
      "opacity": 100,
      "seed": 46
    }
  ],
  "appState": {
    "viewBackgroundColor": "#ffffff",
    "gridSize": 20
  },
  "files": {}
}
